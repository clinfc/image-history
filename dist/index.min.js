!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ImageHistory=e():t.ImageHistory=e()}(window,(function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";var i,n,s,o,a,u,c=this&&this.__classPrivateFieldSet||function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},h=this&&this.__classPrivateFieldGet||function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};function f(t){const e=[];return Object.values(t).forEach(t=>{e.push(...t)}),e}function l(t,e,r,i){const n=new Set;return function(t,e){return e instanceof Element&&t[e.nodeName]instanceof Set}(e,t)&&e[t.nodeName].forEach(e=>{t.hasAttribute(e)&&n.add(t.getAttribute(e))}),[...n]}function d(t,e){const r={};return Object.keys(e).forEach(i=>{Array.from(t.querySelectorAll(i)).forEach(t=>{e[i].forEach(e=>{if(t.hasAttribute(e)){const i=t.getAttribute(e);r[i]?r[i]+=1:r[i]=1}})})}),r}Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,e,r,p=!0){i.set(this,void 0),n.set(this,{}),s.set(this,void 0),o.set(this,void 0),a.set(this,new Map),u.set(this,[]),c(this,i,t),e&&"object"==typeof e&&Object.keys(e).forEach(t=>{h(this,n)[t.toUpperCase()]=new Set(e[t])}),h(this,n).IMG?h(this,n).IMG.add("src"):h(this,n).IMG=new Set(["src"]),!1!==r&&p&&h(this,u).push((function(t){return!/^(blob:.+;base64:|data:)/.test(t)})),Array.isArray(r)?h(this,u).push(...r):"function"==typeof r&&h(this,u).push(r),c(this,o,d(h(this,i),h(this,n))),c(this,s,new MutationObserver(t=>{t.forEach(t=>{if("childList"==t.type){const{addedNodes:e,removedNodes:r}=t;r.forEach(t=>{l(t,h(this,n)).forEach(t=>{this.valid(t)&&h(this,a).set(t,!1)})}),e.forEach(t=>{l(t,h(this,n)).forEach(t=>{this.valid(t)&&h(this,a).set(t,!0)})})}else{const{target:s,oldValue:o,attributeName:u}=t;if(e=h(this,n),r=s,(i=u)&&r instanceof Element&&e[r.nodeName]instanceof Set&&e[r.nodeName].has(i)){o&&this.valid(o)&&h(this,a).set(o,!1);const t=s.getAttribute(u);t&&this.valid(t)&&h(this,a).set(t,!0)}}var e,r,i})})),h(this,s).observe(t,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:f(h(this,n))})}get root(){return h(this,i)}get listener(){const t={};return Object.entries(h(this,n)).forEach(([e,r])=>{t[e]=[...r]}),t}get primordial(){return Object.entries(h(this,o))}statistics(){return Object.entries(d(h(this,i),h(this,n)))}deleted(){return this.all().filter(t=>"deleted"===t.type).map(t=>t.image)}inserted(){return this.all().filter(t=>"inserted"===t.type).map(t=>t.image)}all(){const t=d(h(this,i),h(this,n)),e=Object.keys(h(this,o)).filter(e=>!t[e]),r=[];return h(this,a).forEach((t,i)=>{h(this,o)[i]&&!e.includes(i)||r.push({image:i,type:t?"inserted":"deleted"})}),r}clear(){h(this,a).clear()}destory(){h(this,s).disconnect(),h(this,a).clear(),c(this,n,{}),c(this,o,{})}valid(t){return h(this,u).reduce((e,r)=>e&&r(t),!0)}},i=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,u=new WeakMap}]).default}));
//# sourceMappingURL=index.min.js.map